<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dashboard</title>
    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            background-color: #121212;
            color: white;
        }

        .nav {
            display: flex;
            background-color: #1e1e1e;
            padding: 1rem;
            justify-content: center;
            gap: 1rem;
        }

        .nav button {
            background: none;
            border: none;
            color: #fff;
            padding: 0.5rem 1rem;
            cursor: pointer;
            font-weight: bold;
            border-bottom: 2px solid transparent;
        }

        .nav button.active {
            border-color: #4a90e2;
        }

        .section {
            display: none;
            padding: 2rem;
            max-width: 800px;
            margin: auto;
        }

        .section.active {
            display: block;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        input,
        select,
        textarea {
            width: 100%;
            padding: 0.75rem;
            border: none;
            border-radius: 8px;
            margin-top: 0.25rem;
            background-color: #2c2c2c;
            color: #fff;
            
        }
        textarea{
            resize:none;
            height: 30vh;
        }

        button {
            background-color: #4a90e2;
            color: white;
            border: none;
            border-radius: 8px;
            padding: 0.75rem 1rem;
            cursor: pointer;
            margin-top: 0.5rem;
        }

        button:hover {
            background-color: #357ABD;
        }

        .chat-box {
            border: 1px solid #333;
            padding: 1rem;
            height: 200px;
            overflow-y: auto;
            margin-bottom: 1rem;
            background-color: #1e1e1e;
            border-radius: 8px;
        }

        .chat-box p {
            margin: 0.25rem 0;
        }

        img.generated-img {
            max-width: 100%;
            margin-top: 1rem;
            display: none;
            border-radius: 8px;
        }

        .balao {
            max-width: 70%;
            padding: 0.75rem 1rem;
            border-radius: 18px;
            margin: 0.5rem 0;
            display: inline-block;
            clear: both;
        }

        .user-msg {
            background-color: #4a90e2;
            align-self: flex-end;
            color: white;
            float: right;
            text-align: right;
        }

        .bot-msg {
            background-color: #333;
            color: #ddd;
            float: left;
        }

        .balao span.hora {
            display: block;
            font-size: 0.75rem;
            color: #aaa;
            margin-top: 0.25rem;
        }
    </style>
</head>

<body>

    <div class="nav">
        <button class="active" onclick="showSection('empresas')">Empresas</button>
        <button onclick="showSection('selecionar-empresa')">Selecionar Empresa</button>
        <button onclick="showSection('funcoes')">Agentes</button>
        <button onclick="showSection('chat')">Chat</button>
        <button onclick="showSection('gerador')">Gerador de Imagens</button>
        <button onclick="showSection('IAGeral')">IA Geral</button>
    </div>

    <div id="empresas" class="section active">
        <h2>Cadastro de Empresas</h2>
        <div class="form-group">
            <label>Nome da Empresa</label>
            <input type="text" id="nomeEmpresa">
        </div>
        <div class="form-group">
            <label>Descrição</label>
            <textarea id="descricaoEmpresa" rows="3"></textarea>
        </div>
        <button onclick="cadastrarEmpresa()">Cadastrar</button>
    </div>

    <div id="selecionar-empresa" class="section">
        <h2>Selecionar Empresa</h2>
        <select id="listaEmpresas"></select>
        <button onclick="atualizarLista()">Atualizar Lista</button>
        <br>
        <br>
        <button onclick="selecionarEmpresa()">Selecionar Empresa</button> 
        <button onclick="DeletarEmpresa()">Deletar Empresa</button> 
    </div>

    <div id="funcoes" class="section">
        <h2>Funções da Empresa</h2>
        <select id="funcoesSelect">
            <option>Planejamento</option>
            <option>Design</option>
            <option>Publicidade</option>
            <option>SocialMedia</option>
            <option>Fotografia</option>
            <option>Relations</option>
            <option>Atendimento</option>
            <option>Marketing</option>
            <option>Programador</option>
        </select>
        <br>
        <button onclick="criarAgente()">Criar</button>
        <button onclick="selecionarAgente()">Selecionar</button>
        <button onclick="resetarAgente()">Resetar</button>
        <button onclick="apagarAgente()">Apagar</button>
    </div>

    <div id="chat" class="section">
        <h2>Chat</h2>
        <div class="chat-box" id="chatBox">
            <!-- Balões de mensagens aparecerão aqui -->
        </div>
        <input type="text" id="mensagem" placeholder="Digite sua mensagem">
        <button onclick="enviarMensagem()">Enviar</button>
    </div>




    <div id="gerador" class="section">
        <h2>Gerador de Imagens com IA</h2>
        <img id="imagemIA" class="generated-img" alt="Imagem gerada pela IA" />
        <input type="text" id="promptImagem" placeholder="Descreva a imagem desejada">
        <button onclick="gerarImagem()">Gerar Imagem</button>
    </div>


    <div id="IAGeral" class="section">
        <h2>Chat</h2>
        <div class="chat-box" id="chatBoxIAGeral">
            <!-- Balões de mensagens aparecerão aqui -->
        </div>
        <input type="text" id="mensagemIAGeral" placeholder="Digite sua mensagem">
        <button onclick="enviarMensagemIAGeral()">Enviar</button>
    </div>


    <script>

        if (!localStorage.getItem("empresa")) { localStorage.setItem("empresa", ""); }
        if (!localStorage.getItem("agente")) { localStorage.setItem("agente", ""); }
        //if (!localStorage.getItem("index_empresa")) { localStorage.setItem("index_empresa", ""); }

        if (!localStorage.getItem("lista_de_empresas_nome")) { localStorage.setItem("lista_de_empresas_nome", ""); }



        let empresas = [];
        alimentarListaEmpresas()
        atualizarLista()

        function alimentarListaEmpresas() {//funcionando
            empresas = []; //limpa o array
            empresas = localStorage.getItem("lista_de_empresas_nome").split("##")
        }




        function showSection(id) {//funcionando
            document.querySelectorAll(".section").forEach(sec => sec.classList.remove("active"));
            document.getElementById(id).classList.add("active");

            document.querySelectorAll(".nav button").forEach(btn => btn.classList.remove("active"));
            event.target.classList.add("active");
        }

        // EMPRESAS


        function cadastrarEmpresa() {//funcionando
            const nome = document.getElementById("nomeEmpresa").value;
            const desc = document.getElementById("descricaoEmpresa").value;
            if (nome) {

                if (localStorage.getItem("lista_de_empresas_nome").includes(nome)) {
                    alert("Empresa ja esta cadastrada!");
                    return
                }

                localStorage.setItem("lista_de_empresas_nome", localStorage.getItem("lista_de_empresas_nome") + "##" + nome)
                localStorage.setItem(nome + "_descricao", desc)
                alimentarListaEmpresas()
                atualizarLista()

                //empresas.push({ nome, desc });
                alert("Empresa cadastrada com sucesso!");
                document.getElementById("nomeEmpresa").value = '';
                document.getElementById("descricaoEmpresa").value = '';
            }
        }

        function atualizarLista() {//funcionando
            const select = document.getElementById("listaEmpresas");
            select.innerHTML = '';

            alimentarListaEmpresas()

            empresas.forEach(nome => {
                const option = document.createElement("option");
                option.value = nome;
                option.textContent = nome;
                document.getElementById("listaEmpresas").appendChild(option);
            });

        }

        function selecionarEmpresa() {//funcionando
            const empresa = document.getElementById("listaEmpresas").value;
            localStorage.setItem("empresa", empresa);
            alert(`Empresa selecionada: ${empresa}`);
        }


        function DeletarEmpresa() {//funcionando

            //pega o nome da mepresa que ta atual
            const empresa = document.getElementById("listaEmpresas").value;

            //remove o nome da mepresa da lista "lista_de_empresas_nome"
            let novalista = localStorage.getItem("lista_de_empresas_nome").replace("##" + empresa, "")
            localStorage.setItem("lista_de_empresas_nome", novalista);

            //apaga a descrição da empresa
            localStorage.removeItem(empresa + "_descricao")

            //Libera a empresa seleciona atualmente
            localStorage.setItem("empresa", "");
            localStorage.setItem("agente", "");
            localStorage.setItem("index_empresa", "");

            //Recarrega as listas
            alimentarListaEmpresas()
            atualizarLista()

            alert(`Empresa removida com sucesso`);

        }


        setInterval(() => {//funcionaod
            document.title = localStorage.getItem("empresa") + " - " + localStorage.getItem("agente")
        }, 1);


        function obterDescricaoEmpresa() {//nao teste, mas deve ta funcionando
            if (localStorage.getItem("empresa") == "") {
                alert("Selecione uma empresa antes de executar alguma ação")
                return ""
            }
            if (localStorage.getItem(localStorage.getItem("empresa") + "_descricao")) {
                return localStorage.getItem(localStorage.getItem("empresa") + "_descricao")
            } else {
                return ""
            }
        }

        function obterNomeEmpresa() {//nao teste, mas deve ta funcionando
            if (localStorage.getItem("empresa") == "") {
                alert("Selecione uma empresa antes de executar alguma ação")
                return ""
            }
            return localStorage.getItem("empresa")
        }

        function obterPromptInicial()//funcionando
        {

            let final = ""
            let empresa = localStorage.getItem("empresa");
            let agente = localStorage.getItem("agente");
            //--------------------------------------
            if (empresa === "") {
                alert("Selecione uma empresa antes de executar algo")
                return "";
            }
            //--------------------------------------
            if (agente === "") {
                alert("Selecione um agente antes de executar algo")
                return "";
            }
            //--------------------------------------
            let intro = "A partir de agora, voce fará parte de uma agencia de marketing, e sera especialista e responsavel em ";
            let funcao = "";

            //--------------------------------------
            if (agente == "Planejamento") {
                funcao = "definir metas, identificar o público-alvo, posicionamento da marca e criar planos de ação alinhados as necessidades do cliente";
            }
            if (agente == "Design") {
                funcao = "envolve redatores, designers graficos, ilustradores e criativos que desenvolvem conteudo visual e textual para campanhas, anuncios e materiais diversos";
            }
            if (agente == "Publicidade") {
                funcao = "gerentes de midia, especialistas em compra de midia digital e tradicional, que planejam e executam campanhas publicitorias, otimizando investimentos em canais como Google Ads, Facebook Ads, TV, radio, entre outros";
            }

            if (agente == "SocialMedia") {
                funcao = "profissionais que gerenciam as redes sociais, elaboram conteudo para plataformas como Instagram, TikTok, LinkedIn, respondem ao publico e monitoram engajamento";
            }
            if (agente == "Fotografia") {
                funcao = "criar conteudo audiovisual de alta qualidade para campanhas, videos institucionais, comerciais e materiais para redes sociais";
            }
            if (agente == "Relations") {
                funcao = "relacionamento com clientes, imprensa e influenciadores, alem de produzir conteudo para comunicação interna e externa";
            }
            if (agente == "Atendimento") {
                funcao = "entendem as necessidades do cliente, traduzem essas demandas em ações e fazem o acompanhamento dos resultados";
            }
            if (agente == "Marketing") {
                funcao = "otimizam sites e conteudos para motores de busca, aumentando a visibilidade online da marca";
            }
            if (agente == "Programador") {
                funcao = "programar sites, seja na parte front end ou backend, utilizando qualquer liguangem que seja solicitada. Tambem consegue desenvolver aplicativos para desktop, mobile e sites.";
            }

            let descricao_empresa = localStorage.removeItem(empresa + "_descricao")

            final = intro + funcao + ". A empresa que voce sera responsavel, se chama " + empresa + ", descrição da empresa: " + descricao_empresa;

            return final;
        }
        //------------------------------------------------------------



        // Agentes

        const listaAgentes = [
            "Planejamento",
            "Design",
            "Publicidade",
            "SocialMedia",
            "Fotografia",
            "Relations",
            "Atendimento",
            "Marketing",
            "Programador"
        ]

        function criarAgente() {

            const agente_selecionado_no_combo = document.getElementById("funcoesSelect").value;

            let empresa = localStorage.getItem("empresa");
            //let agente = localStorage.getItem("agente");
            //--------------------------------------
            if (empresa === "") {
                alert("Selecione uma empresa antes de criar um agente")
                console.log("1")
                return;
            }
            //--------------------------------------
            if (localStorage.getItem(empresa + "_agente_" + agente_selecionado_no_combo)) {
                alert("Ja existe um agente de " + agente_selecionado_no_combo + " para a empresa " + empresa)
                console.log("2")
                //return;
            }
            else {
                localStorage.setItem(empresa + "_agente_" + agente_selecionado_no_combo, " ")
                localStorage.setItem("agente", "")
                alert("Foi criado um agente de " + agente_selecionado_no_combo + " para a empresa " + empresa + " com sucesso!")
                console.log("3")
            }

        }

        function selecionarAgente() {

            const agente_selecionado_no_combo = document.getElementById("funcoesSelect").value;
            let empresa = localStorage.getItem("empresa");

            if (empresa === "") {
                alert("Selecione uma empresa antes de criar um agente")
                console.log("1")
                return;
            }
            else if (localStorage.getItem(empresa + "_agente_" + agente_selecionado_no_combo)) {
                //alert("Ja existe um agente de " + agente_selecionado_no_combo + " para a empresa " + empresa)
                localStorage.setItem("agente", agente_selecionado_no_combo);
                alert("Agente de " + agente_selecionado_no_combo + " selecionado para a empresa " + empresa)
            }
            else {
                alert("Não existe um agente de " + agente_selecionado_no_combo + " para a empresa " + empresa + "!")
            }
        }

        function resetarAgente() {
            const agente_selecionado_no_combo = document.getElementById("funcoesSelect").value;
            let empresa = localStorage.getItem("empresa");

            if (empresa === "") {
                alert("Selecione uma empresa antes de criar um agente")
                console.log("1")
                return;
            }

            if (localStorage.getItem(empresa + "_agente_" + agente_selecionado_no_combo)) {

                localStorage.setItem(empresa + "_agente_" + agente_selecionado_no_combo, " ")
                //localStorage.setItem("agente", "");
                alert("Agente de " + agente_selecionado_no_combo + " da empresa " + empresa + " resetado com sucesso!")
            }
            else {
                alert("Não existe um agente de " + agente_selecionado_no_combo + " para a empresa " + empresa + "!")
            }
        }

        function apagarAgente() {

            const agente_selecionado_no_combo = document.getElementById("funcoesSelect").value;
            let empresa = localStorage.getItem("empresa");

            if (empresa === "") {
                alert("Selecione uma empresa antes de criar um agente")
                console.log("1")
                return;
            }

            if (localStorage.getItem(empresa + "_agente_" + agente_selecionado_no_combo) !== null) {

                localStorage.removeItem(empresa + "_agente_" + agente_selecionado_no_combo)
                localStorage.setItem("agente", "");
                alert("Agente de " + agente_selecionado_no_combo + " da empresa " + empresa + " removido com sucesso!")
            }
            else {
                alert("Não existe um agente de " + agente_selecionado_no_combo + " para a empresa " + empresa + "!")
            }
        }






        // CHAT

        function enviarMensagem() {
            const input = document.getElementById("mensagem");
            const chat = document.getElementById("chatBox");
            const texto = input.value.trim();

            if (texto) {
                const horario = new Date().toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' });

                // Mensagem do usuário
                const userBubble = document.createElement("div");
                userBubble.className = "balao user-msg";
                userBubble.innerHTML = `${texto}<span class="hora">${horario}</span>`;
                chat.appendChild(userBubble);

                input.value = '';
                chat.scrollTop = chat.scrollHeight;

                // Resposta do bot
                setTimeout(() => {
                    const horarioBot = new Date().toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' });
                    const botBubble = document.createElement("div");
                    botBubble.className = "balao bot-msg";
                    // botBubble.innerHTML = `Olá! Você disse: ${texto}<span class="hora">${horarioBot}</span>`;
                    chat.appendChild(botBubble);

                    efeitoDigitar(botBubble, `Olá! Você disse: ${texto}<span class="hora">${horarioBot}</span>`);

                    chat.scrollTop = chat.scrollHeight;
                }, 800);
            }
        }

        // CHAT IAGeral

        function enviarMensagemIAGeral() {
            const input = document.getElementById("mensagemIAGeral");
            const chat = document.getElementById("chatBoxIAGeral");
            const texto = input.value.trim();

            if (texto) {
                const horario = new Date().toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' });

                // Mensagem do usuário
                const userBubble = document.createElement("div");
                userBubble.className = "balao user-msg";
                userBubble.innerHTML = `${texto}<span class="hora">${horario}</span>`;
                chat.appendChild(userBubble);

                input.value = '';
                chat.scrollTop = chat.scrollHeight;

                // Resposta do bot
                setTimeout(() => {
                    const horarioBot = new Date().toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' });
                    const botBubble = document.createElement("div");
                    botBubble.className = "balao bot-msg";
                    // botBubble.innerHTML = `Olá! Você disse: ${texto}<span class="hora">${horarioBot}</span>`;
                    chat.appendChild(botBubble);

                    efeitoDigitarIAGeral(botBubble, `Olá! Você disse: ${texto}<span class="hora">${horarioBot}</span>`);

                    chat.scrollTop = chat.scrollHeight;
                }, 800);
            }
        }

        function efeitoDigitar(elementoDoTexto, texto, velocidade = 2) {

            var indexxxxxxxxxxxxxxxxxxxx = 0
            function digitar() {
                elementoDoTexto.innerHTML = texto.substring(0, indexxxxxxxxxxxxxxxxxxxx);
                indexxxxxxxxxxxxxxxxxxxx++;
                if (indexxxxxxxxxxxxxxxxxxxx <= texto.length) {
                    setTimeout(() => {
                        digitar();
                        document.getElementById("chatBox").scrollTop = document.getElementById("chatBox").scrollHeight;
                    }, velocidade);
                }
            }
            digitar()
        }


        function efeitoDigitarIAGeral(elementoDoTexto, texto, velocidade = 2) {

            var indexxxxxxxxxxxxxxxxxxxx = 0
            function digitar() {
                elementoDoTexto.innerHTML = texto.substring(0, indexxxxxxxxxxxxxxxxxxxx);
                indexxxxxxxxxxxxxxxxxxxx++;
                if (indexxxxxxxxxxxxxxxxxxxx <= texto.length) {
                    setTimeout(() => {
                        digitar();
                        document.getElementById("chatBoxIAGeral").scrollTop = document.getElementById("chatBoxIAGeral").scrollHeight;
                    }, velocidade);
                }
            }
            digitar()
        }






        // GERADOR DE IMAGEM (mock visual)
        function gerarImagem() {
            const prompt = document.getElementById("promptImagem").value;
            const img = document.getElementById("imagemIA");
            if (prompt.trim()) {
                // Apenas simulação
                img.src = "https://placehold.co/600x300?text=" + encodeURIComponent(prompt);
                img.style.display = "block";
            }
        }
    </script>
</body>

</html>